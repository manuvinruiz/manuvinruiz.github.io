---
title: ROSPlan documentation, planner
---
<!DOCTYPE html>
<html lang="en-us">
	<head>
		<meta charset="UTF-8">
		<title>ROSPlan by KCL-Planning</title>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" type="text/css" href="../stylesheets/normalize.css" media="screen">
		<link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
		<link rel="stylesheet" type="text/css" href="../stylesheets/stylesheet.css" media="screen">
		<link rel="stylesheet" type="text/css" href="../stylesheets/github-light.css" media="screen">
		<link rel="stylesheet" type="text/css" href="../stylesheets/syntax.css" media="screen">
		<script src="../jquery.js"></script> 
		<script> 
		$(function(){
		  $("#includedContent").load("../templates/nav-main.html"); 
		  $("#includedSideBar").load("../templates/nav-sidebar.html"); 
		});
		</script>
	</head>
	<body>
    	<div id="includedContent"></div>

		<section class="main-content">

	    	<div id="includedSideBar"></div>
			<section class="documentation-content">

			<h2>Generating a Problem Instance</h2><a href="#problem"></a>
			<p>The default problem generated is a planning problem in PDDL 2.1 or earlier. The problem is generated by <em>rosplan_planning_system::PDDLProblemGenerator</em>. The default problem generation uses a domain file and the information stored in the Knowledge Management System. This information is requested from the Knowledge Base as described in <a href="http://kcl-planning.github.io/ROSPlan/documentation/knowledge_base_problem.html">fetching problem instance</a>. The response is written as a PDDL problem instance.</p>

			<img src="images/dia_problem.png" class="chart"/>

			<p>By default the problem is generated before each planning attempt. This behaviour can be disabled using a parameter, as described in <a href="http://kcl-planning.github.io/ROSPlan/documentation/planning_system_launch.html">launching the planning system</a>.</p>

			<p>The problem is generated, and:</p>
			<ol>
			<li>Written to a file. The file path is specified by a parameter. See <a href="http://kcl-planning.github.io/ROSPlan/documentation/planning_system_launch.html">launching the planning system</a>.</li>
			<li>Published on a ROS topic.</li>
			</ol>

			<p>The PDDL problem instance is published on a ROS topic: <em>/kcl_rosplan/generate_planning_problem</em>. The message type is <em>std_msgs::String</em>.</p>

			<h4>rosplan_planning_system::PDDLProblemGenerator</h4>

			<p>The problem instance is (re)generated before each planning attempt. It is generated by requesting an up-to-date model from the Knowledge Base. More information on this can be found in <a href="http://kcl-planning.github.io/ROSPlan/documentation/knowledge_base_problem.html">fetching problem instance</a>.</p>
{% highlight c++ linenos=table %}
/**
 * This class is responsible for generating the PDDL instance.
 * This is done by using the objects already retrieved and stored (see PlanningEnvironment.h).
 */
#include <string>
#include "PlanningEnvironment.h"

#ifndef KCL_PDDLproblemgenerator
#define KCL_PDDLproblemgenerator

namespace KCL_rosplan {

	class PDDLProblemGenerator
	{
	private:

		void makeHeader(PlanningEnvironment environment, std::ofstream &pFile);
		void makeInitialState(PlanningEnvironment environment, std::ofstream &pFile);
		void makeGoals(PlanningEnvironment environment, std::ofstream &pFile);

	public:

		void generatePDDLProblemFile(PlanningEnvironment &environment, std::string &problemPath);

	};
} // close namespace

#endif
{% endhighlight %}

			<p>The implementation of the public method <em>generatePDDLProblemFile</em> is shown below:</p>
{% highlight c++ linenos=table %}
/**
 * generates a PDDL problem file.
 * This file is later read by the planner.
 */
void PDDLProblemGenerator::generatePDDLProblemFile(PlanningEnvironment &environment, std::string &problemPath) {

	ROS_INFO("KCL: (PS) Generating PDDL problem file %s", problemPath.c_str());
	std::ofstream pFile;
	pFile.open((problemPath).c_str());

	makeHeader(environment, pFile);
	makeInitialState(environment, pFile);
	makeGoals(environment, pFile);
}
{% endhighlight %}

			<p></p>

			</section>

			<footer class="site-footer">
				<span class="site-footer-owner"><a href="https://github.com/KCL-Planning/ROSPlan">ROSPlan</a> is maintained by <a href="https://github.com/KCL-Planning">KCL-Planning</a>.</span>
				<span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
			</footer>

		</section>


	</body>
</html>
